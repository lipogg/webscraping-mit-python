
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>8.3. Beispiel 2: Library of Congress API &#8212; Webscraping für Geisteswissenschaften</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/08/subchapters/03_loc_api';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="9. Anwendungsfall III: Dynamische Webseiten" href="../../09/09_intro.html" />
    <link rel="prev" title="8.2. Beispiel 1: DraCor API" href="02_dracor_api.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Webscraping für Geisteswissenschaften - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Webscraping für Geisteswissenschaften - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Webscraping mit Python für Geisteswissenschaften
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../01/01_intro.html">1. Einstieg</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../01/subchapters/01_was_ist_webscraping.html">1.1. Was ist Web Scraping?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/subchapters/02_warum_webscraping_lernen.html">1.2. Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/subchapters/03_semesterplan.html">1.3. Semesterplan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/subchapters/04_lernziele.html">1.4. Lernziele</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/subchapters/05_organisation.html">1.5. Organisatorisches</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../02/02_intro.html">2. Python I</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../02/subchapters/01_jupyterlite.html">2.1. JupyterLite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/subchapters/01_style.html">2.2. Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/subchapters/01_hilfe.html">2.3. Hilfe!!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/subchapters/02_grundbegriffe.html">2.4. Grundbegriffe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/subchapters/03_datentypen.html">2.5. Einfache Datentypen, Strings und Operatoren</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/subchapters/04_variablen.html">2.6. Variablen</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../03/03_intro.html">3. Python II</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../03/subchapters/01_datentypen.html">3.1. Zusammengesetzte Datentypen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../03/subchapters/02_kontrollstrukturen.html">3.2. Kontrollstrukturen</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../04/04_intro.html">4. Python III</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../04/subchapters/01_funktionen.html">4.1. Funktionen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../04/subchapters/02_pakete.html">4.2. Module, Pakete, Bibliotheken</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../05/05_intro.html">5. Installation und Setup</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../05/subchapters/01_vorbereitung.html">5.1. Vorbereitung</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../05/subchapters/02_installation_setup.html">5.2. Installation und Setup</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../06/06_intro.html">6. Einstieg Webscraping</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../06/subchapters/01_rechtliches.html">6.1. Der rechtliche Rahmen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../06/subchapters/02_html.html">6.2. HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../06/subchapters/03_css.html">6.3. CSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../06/subchapters/04_http.html">6.4. Client, Server, HTTP</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../07/07_intro.html">7. Statische Webseiten</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../07/subchapters/01_einstieg_beautifulsoup.html">7.1. Einstieg BeautifulSoup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../07/subchapters/02_fortsetzung_beautifulsoup.html">7.2. Fortsetzung BeautifulSoup</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../08_intro.html">8. APIs (Exkurs)</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_apis.html">8.1. APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_dracor_api.html">8.2. Beispiel DraCor-API</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">8.3. Beispiel LOC-API</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../09/09_intro.html">9. Dynamische Webseiten</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../09/subchapters/01_statisch_vs_dynamisch.html">9.1. Statisch vs. Dynamisch?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../09/subchapters/02_einstieg_selenium.html">9.2. Einstieg Selenium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../09/subchapters/03_fortsetzung_selenium.html">9.3. Fortsetzung Selenium</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../10/10_intro.html">10. Pandas (Exkurs)</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../10/subchapters/01_pandas_bereinigen.html">10.1. Daten bereinigen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../10/subchapters/02_pandas_visualisieren.html">10.2. Daten visualisieren</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../11/11_intro.html">11. Tipps und Tricks</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../11/subchapters/01_fetch_xhr.html">11.1. Selenium ist kein Hammer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../11/subchapters/02_sessions_cookies.html">11.2. Sessions und Cookies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../11/subchapters/03_apis_tokens.html">11.3. Authentifizierung, Autorisierung und APIs</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/lipogg/webscraping-mit-python" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/chapters/08/subchapters/03_loc_api.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Beispiel 2: Library of Congress API</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datenqualitat-untersuchen">8.3.1. Datenqualität untersuchen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suche-formulieren">8.3.2. Suche formulieren</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anfrage-formulieren">8.3.3. Anfrage formulieren</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#abfrage-aller-volltexte-mit-book-review">8.3.4. Abfrage aller Volltexte mit “book review”</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rate-limits-berucksichtigen-und-die-abfragerate-steuern">8.3.5. Rate Limits berücksichtigen und die Abfragerate steuern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quellen">8.3.6. Quellen</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="beispiel-2-library-of-congress-api">
<h1><span class="section-number">8.3. </span>Beispiel 2: Library of Congress API<a class="headerlink" href="#beispiel-2-library-of-congress-api" title="Link to this heading">#</a></h1>
<p>Die Library of Congress (LOC) bietet eine Reihe sehr gut dokumentierter APIs zur Abfrage von Metadaten, Dateien und Volltexten aus dem Bestand der Bibliothek. Eine davon ist die API der Sammlung US-amerikanischer historischer Zeitungen Chronicling America. Diese API werden wir in dieser Stunde kennenlernen.</p>
<ul class="simple">
<li><p>Übersicht über die LOC APIs: <a class="reference external" href="https://guides.loc.gov/digital-scholarship/accessing-digital-materials#s-lib-ctab-26648178-2">https://guides.loc.gov/digital-scholarship/accessing-digital-materials#s-lib-ctab-26648178-2</a></p></li>
<li><p>Dokumentation zur Chronicling America API: <a class="reference external" href="https://libraryofcongress.github.io/data-exploration/loc.gov%20JSON%20API/Chronicling_America/README.html">https://libraryofcongress.github.io/data-exploration/loc.gov JSON API/Chronicling_America/README.html</a></p></li>
</ul>
<p>Zunächst machen wir uns mit der Chronicling America API vertraut.</p>
<div class="tip admonition">
<p class="admonition-title">Verständnisfragen</p>
<ul class="simple">
<li><p>Welche Daten können darüber abgefragt werden?</p></li>
<li><p>Was ist euer Leseeindruck? Ist die Dokumentation vollständig, ausführlich, verständlich?</p></li>
<li><p>An wen richtet sich die API und die Dokumentation?</p></li>
<li><p>Vergleicht die Dokumentationsseiten zur Chronicling America API mit der Dokumentation der Prints and Photographs Online Catalog API: <a class="reference external" href="https://www.loc.gov/pictures/api">https://www.loc.gov/pictures/api</a>. An wen richtet sich dieser Dokumentationstext?</p></li>
</ul>
</div>
<p>Für unser Beispiel werden wir die Volltexte zu allen Ergebnissen einer Suche nach einem Schlüsselbegriff abfragen und herunterladen. Die wichtigsten Informationen zur Verwendung der API und für unseren Anwendungsfall finden wir im Abschnitt “Definitions: API Query Parameters for Newspapers”. Zwei Hinweise sind dabei insbesondere aufschlussreich:</p>
<blockquote>
<div><p>The easiest way to create a URL for your API query is to perform an Advanced Search at Chronicling America. If you performed an Advanced Search to create your API Query, we recommend including some of the additional query parameters. The structure of an API Query URL looks like this: <a class="reference external" href="https://www.loc.gov/collections/chronicling-america/?%7Bqueryparameters%7D&amp;amp;%7Bqueryparameters%7D?fo=json">https://www.loc.gov/collections/chronicling-america/?{queryparameters}&amp;{queryparameters}?fo=json</a></p>
</div></blockquote>
<blockquote>
<div><p>Note: If you’re looking to download full text from the newspaper pages in a given search result, note that the full text (from OCR) is captured for each page within the “full_text” JSON field. For example: <a class="reference external" href="https://www.loc.gov/resource/sn83045462/1922-12-26/ed-1/?sp=22&amp;amp;q=clara+bow&amp;amp;fo=json">https://www.loc.gov/resource/sn83045462/1922-12-26/ed-1/?sp=22&amp;q=clara+bow&amp;fo=json</a></p>
</div></blockquote>
<section id="datenqualitat-untersuchen">
<h2><span class="section-number">8.3.1. </span>Datenqualität untersuchen<a class="headerlink" href="#datenqualitat-untersuchen" title="Link to this heading">#</a></h2>
<p>Der letzte der beiden Hinweise gibt Aufschluss über die Qualität der Volltexte: Diese sind mithilfe von OCR-Verfahren erstellt, also mithilfe automatischer Bilderkennung (OCR steht für Optical Character Recognition). Wenn wir auf das verlinkte Beispiel klicken, öffnet sich zunächst eine JSON-Datei im Browser, die Metadaten zur angefragten Ressource als auch Links zu der Resource selbst in verschiedenen Dateiformaten enthält. Diese finden sich unter dem Schlüssel “resource” und können mithilfe der Tastenkombination Strg + F und Suche nach “full_text” gefunden werden:</p>
<figure class="align-default" id="id245">
<a class="bg-transparent reference internal image-reference" href="../../../_images/json_resource.png"><img alt="Ansicht einer LOC Ressource im JSON-Format" class="bg-transparent" src="../../../_images/json_resource.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.4 </span><span class="caption-text">Informationen zu einer Ressource im JSON-Format abrufen</span><a class="headerlink" href="#id245" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ein Klick auf die unter “fulltext_file” verlinkte Ressource öffnet ein weiteres JSON-Dokument, das den eigentlichen Volltext enthält:</p>
<figure class="align-default" id="id246">
<a class="bg-transparent reference internal image-reference" href="../../../_images/json_full_text.png"><img alt="Ansicht des Volltexts einer LOC Ressource mit OCR-Fehlern" class="bg-transparent" src="../../../_images/json_full_text.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.5 </span><span class="caption-text">Mithilfe von OCR erstellter Volltext einer Ressource, inkl. OCR-Fehler</span><a class="headerlink" href="#id246" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>JSON im Browser ansehen</p>
<p>Firefox stellt JSON-Dateien im Browser sehr übersichtlich dar. Das ist aber nicht bei allen Browsern der Fall. Zur Ansicht der JSON-Datei im Chrome Browser kann auf die Entwicklertools zurückgegriffen werden. Die Standardansicht ist nämlich sehr schwer lesbar, weil der JSON-String nicht formatiert ist. Um eine formatierte Ansicht zu erhalten, befolgt die folgenden Schritte: Entwicklertools öffnen -&gt; “Sources”-Tab auswählen-&gt; Link anklicken</p>
</div>
<p><strong>Bevor ihr ein Skript zum Herunterladen der Daten über eine API schreibt, solltet ihr diese also vorab inspizieren und entscheiden, ob ihr die Daten in der verfügbaren Qualität zur Beantwortung eurer Fragestellung überhaupt nutzen könnt. Denn anders als der Inhalt einer Webseite, den ihr mit BeautifulSoup scraped, ist die Qualität der Daten, die Museen, Archive und Bibliotheken bereitstellen, nicht direkt einsehbar. Auch die Vollständigkeit der extrahierten Daten muss vorab abgeschätzt werden.</strong> Eine Suche nach Schlüsselbegriffen in einem Volltext, der mithilfe von OCR-Verfahren erstellt wurde, liefert beispielsweise immer nur diejenigen Zeitungen, in denen die Suchwörter auch korrekt erkannt wurden.</p>
</section>
<section id="suche-formulieren">
<h2><span class="section-number">8.3.2. </span>Suche formulieren<a class="headerlink" href="#suche-formulieren" title="Link to this heading">#</a></h2>
<p>Um herauszufinden, wie die Abfrage-URL für eine Suche nach bestimmten Schlüsselbegriffen aussehen muss, können wir also zunächst über die Suchmaske des Onlinekatalogs eine Suche formulieren: <a class="reference external" href="https://www.loc.gov/collections/chronicling-america/">https://www.loc.gov/collections/chronicling-america/</a></p>
<p>Wir formulieren die Suche wie folgt:</p>
<figure class="align-default" id="id247">
<a class="bg-transparent reference internal image-reference" href="../../../_images/loc_ca_suche.png"><img alt="Suchmaske Chronicling America" class="bg-transparent" src="../../../_images/loc_ca_suche.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.6 </span><span class="caption-text">Einfache Suche über die Suchmaske der Seite Chronicling America.</span><a class="headerlink" href="#id247" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Die Suche liefert drei Ergebnisse und vor allem eine wichtige Information zum Verhalten der Volltextsuche: Es wird nicht nur die exakte Wortkombination “book review” gefunden, sondern auch Wortkombinationen über Satzgrenzen hinweg wie “book. Review” und Wortkombinationen, in denen die Suchbegriffe vorkommen wie “book reviewed”. Auch das ist zur Einschätzung der Vollständigkeit und Qualität der extrahierten Daten wichtig.</p>
<figure class="align-default" id="id248">
<a class="bg-transparent reference internal image-reference" href="../../../_images/search_results.png"><img alt="Ergebnisse der Suche" class="bg-transparent" src="../../../_images/search_results.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.7 </span><span class="caption-text">Ergebnisse der Suche</span><a class="headerlink" href="#id248" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Wir weiten die Suche auf 200 Jahre aus und erhalten nun 23.614 Ergebnisse. Davon werden aber nur 40 auf der ersten Seite angezeigt. Auch das ist eine wichtige Information, wie wir noch sehen werden.</p>
<figure class="align-default" id="id249">
<a class="bg-transparent reference internal image-reference" href="../../../_images/search_and_results_extended.png"><img alt="Ergebnisse der erweiterten Suche" class="bg-transparent" src="../../../_images/search_and_results_extended.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.8 </span><span class="caption-text">Ergebnisse der erweiterten Suche</span><a class="headerlink" href="#id249" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="tip admonition">
<p class="admonition-title">Verständnisfragen</p>
<ul class="simple">
<li><p>Welche weiteren Parameter akzeptiert die Chronicling America API? Verwendet die Suchmaske unter dem <a class="reference external" href="https://chroniclingamerica.loc.gov/search/pages/results/#tab=tab_advanced_search">Tab Advanced Search</a> und beobachtet, wie verschiedene Parameter in die URL eingefügt werden.</p></li>
<li><p>Wie kann nur nach deutschsprachigen Texten gesucht werden?</p></li>
</ul>
</div>
</section>
<section id="anfrage-formulieren">
<h2><span class="section-number">8.3.3. </span>Anfrage formulieren<a class="headerlink" href="#anfrage-formulieren" title="Link to this heading">#</a></h2>
<p>Mit diesen Informationen können wir nun versuchen herauszufinden, wie die Anfrage-URL aussehen muss. Wir gleichen dazu die URL, die bei unserer Suche über die Suchmaske automatisch zusammengesetzt wurde, mit der allgemeinen Struktur der Anfrage-URL aus den Dokumentationsseiten ab. Die durch die Verwendung der Suchmaske zusammengesetze URL ist <a class="reference external" href="https://www.loc.gov/collections/chronicling-america/?dl=page&amp;amp;end_date=1936-09-03&amp;amp;ops=PHRASE&amp;amp;qs=book+review&amp;amp;searchType=advanced&amp;amp;start_date=1736-09-03">https://www.loc.gov/collections/chronicling-america/?dl=page&amp;end_date=1936-09-03&amp;ops=PHRASE&amp;qs=book+review&amp;searchType=advanced&amp;start_date=1736-09-03</a>. Die allgemeine Form ist dagegen <a class="reference external" href="https://www.loc.gov/collections/chronicling-america/?%7Bqueryparameters%7D&amp;amp;%7Bqueryparameters%7D?fo=json">https://www.loc.gov/collections/chronicling-america/?{queryparameters}&amp;{queryparameters}?fo=json</a>. Um die Anfrageparameter später bequem austauschen zu können, erstellen wir dafür Variablen und fügen die Anfrage-URL mithilfe eines F-Strings zusammen. Was die einzelnen Parameter bedeuten, können wir dem Abschnitt “Definitions: API Query Parameters for Newspapers” entnehmen. Die Variablennamen wählen wir entsprechend der Bedeutung der Parameter. Beim Umschreiben der URL fällt auf, dass der Parameter “fo=json” in unserer Suchmasken-URL nicht vorkommt. Per Default werden die Ergebnisse im HTML-Format zur Ansicht über den Browser geliefert. Wenn wir die Ergebnisse später mit requests verarbeiten wollen, dann müssen wir also hier den Parameter “fo=json” hinzufügen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://www.loc.gov/collections/chronicling-america/&quot;</span>
<span class="n">display_level</span> <span class="o">=</span> <span class="s2">&quot;dl=page&quot;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s2">&quot;end_date=1936-09-03&quot;</span>
<span class="n">search_operation</span> <span class="o">=</span> <span class="s2">&quot;ops=PHRASE&quot;</span>
<span class="n">query_terms</span> <span class="o">=</span> <span class="s2">&quot;qs=book+review&quot;</span>
<span class="n">search_type</span> <span class="o">=</span> <span class="s2">&quot;searchType=advanced&quot;</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s2">&quot;start_date=1736-09-03&quot;</span>
<span class="n">response_format</span> <span class="o">=</span> <span class="s2">&quot;fo=json&quot;</span>

<span class="n">request_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">?</span><span class="si">{</span><span class="n">display_level</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">search_operation</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">query_terms</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">search_type</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">response_format</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Mit dieser Struktur wird direkt deutlich, welche Suchparameter wir verwendet haben. Etwas sauberer wäre es vermutlich allerdings, wenn wir die Kürzel für die Suchparameter (dl, end_date, fo, …) direkt in den F-String einfügen und nur für die Werte Variablen definieren. Wir lassen unsere Anfrage-URL aber erst einmal so. Zunächst testen wird die Anfrage-URL, indem wir sie einfach im Browser aufrufen:</p>
<figure class="align-default" id="id250">
<a class="bg-transparent reference internal image-reference" href="../../../_images/response_full.png"><img alt="JSON-Datei mit Antwort auf Anfrage im Browser" class="bg-transparent" src="../../../_images/response_full.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.9 </span><span class="caption-text">Anfrage-URL im Browser testen</span><a class="headerlink" href="#id250" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In der überblicklichen Darstellung im Browser fällt direkt auf, dass wir nur 40 Ergebnisse bekommen haben (Schlüssel “results”). Wir stellen die Anfrage nun mithilfe von requests und überprüfen diesen Umstand:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">request_url</span><span class="p">)</span>
<span class="n">response_dict</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="n">search_results</span> <span class="o">=</span> <span class="n">response_dict</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">search_results</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40
</pre></div>
</div>
</div>
</div>
<p>Wie können wir den Rest der 23.614 Suchergebnisse erhalten? Im Abschnitt “Definitions: API Query Parameters for Newspapers” lässt sich dazu keine Information finden, aber praktischerweise bietet die Library of Congress am Ende der Seite einige Jupyter Notebooks mit Beispielabfragen, unter anderem das Notebook “Downloading Search Results from Chronicling America”:  <a class="reference external" href="https://libraryofcongress.github.io/data-exploration/loc.gov%20JSON%20API/Chronicling_America/ChronAm-download_results.html">https://libraryofcongress.github.io/data-exploration/loc.gov JSON API/Chronicling_America/ChronAm-download_results.html</a></p>
<p>Dem Notebook können wir entnehmen, dass weitere Ergebnisseiten über den Schlüssel “pagination” abgerufen werden können, und zwar mit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#        if data[&quot;pagination&quot;][&quot;next&quot;] is not None:</span>
<span class="c1">#            next_url = data[&quot;pagination&quot;][&quot;next&quot;]</span>
<span class="c1">#            get_item_ids(next_url, items, conditional)</span>
</pre></div>
</div>
</div>
</div>
<p>Diesen Code können wir später für unsere Zwecke anpassen.</p>
</section>
<section id="abfrage-aller-volltexte-mit-book-review">
<h2><span class="section-number">8.3.4. </span>Abfrage aller Volltexte mit “book review”<a class="headerlink" href="#abfrage-aller-volltexte-mit-book-review" title="Link to this heading">#</a></h2>
<p>Zunächst müssen wir aber eine viel dringendere Frage klären: Wir haben zwar mit unserer Anfrage-URL die Suchergebnisse im JSON-Format erhalten. Aber wie finden wir darüber die Volltexte? Die Volltexte haben wir ja über die Seiten der Ressourcen selbst bekommen, also über URLs der Form <a class="reference external" href="https://www.loc.gov/resource/sn83045462/1922-12-26/ed-1/?sp=22&amp;amp;q=clara+bow&amp;amp;fo=json">https://www.loc.gov/resource/sn83045462/1922-12-26/ed-1/?sp=22&amp;q=clara+bow&amp;fo=json</a>, und auf der Ressourcenseite haben wir den Link zum Volltext selbst unter dem Schlüssel “fulltext_file” gefunden. Der Link zum Volltext hatte dabei die Form <a class="reference external" href="https://tile.loc.gov/text-services/word-coordinates-service?segment=/service/ndnp/dlc/batch_dlc_dalek_ver01/data/sn83045462/00280657232/1922122601/0584.xml&amp;amp;format=alto_xml&amp;amp;full_text=1&amp;amp;q=clara%20bow">https://tile.loc.gov/text-services/word-coordinates-service?segment=/service/ndnp/dlc/batch_dlc_dalek_ver01/data/sn83045462/00280657232/1922122601/0584.xml&amp;format=alto_xml&amp;full_text=1&amp;q=clara bow</a>.
Um an den Link zum Volltext zu kommen, könnten wir also die Ergebnisse unserer Suche durchgehen und für jedes Ergebnis den Link zur Ressourcenseite aufrufen, um an den Link zum Volltext zu kommen. Aber das würde eine zusätzliche Anfrage je Ergebnis erfordern. Es gibt aber noch eine zweite Möglichkeit: Unter dem Schlüssel “word_coordinates_url” steht ein sehr ähnlicher Link, der ebenfalls zu einer JSON-Datei mit dem Volltext führt, allerdings nicht zum kompletten Volltext der Ressource, sondern nur dem Ausschnitt, in dem unsere Suchbegriffe stehen: <a class="reference external" href="https://tile.loc.gov/text-services/word-coordinates-service?format=alto_xml&amp;amp;segment=%2Fservice%2Fndnp%2Fmdu%2Fbatch_mdu_galena_ver02%2Fdata%2Fsn89060092%2F00279521808%2F1911100601%2F0360.xml&amp;amp;q=book+review&amp;amp;relevant_snippet=1">https://tile.loc.gov/text-services/word-coordinates-service?format=alto_xml&amp;segment=%2Fservice%2Fndnp%2Fmdu%2Fbatch_mdu_galena_ver02%2Fdata%2Fsn89060092%2F00279521808%2F1911100601%2F0360.xml&amp;q=book+review&amp;relevant_snippet=1</a></p>
<p>Der entscheidende Unterschied ist, dass hier statt des Parameters “full_text=1” “relevant_snippet=1” steht, und dass der Link zusätzlich den Suchparameter “q=book+review” enthält. Je nachdem, in welchem Umfang der Volltext heruntergeladen werden soll, können die Parameter einfach ausgewechselt werden.</p>
<p>Das probieren wir erst einmal nur für die erste Ergebnisseite aus, und erweitern danach den Code so, dass die Volltexte für alle Ergebnisseiten abgefragt werden. Die folgende Schleife entfernt die Suchparameter “q=book+review” und “relevant_snippet=1” und fügt stattdessen den Parameter “full_text=1” an den Link an.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">search_results</span><span class="p">:</span>
    <span class="n">fulltext_url</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;word_coordinates_url&quot;</span><span class="p">]</span>
    <span class="n">fulltext_base</span> <span class="o">=</span> <span class="n">fulltext_url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fulltext_request_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fulltext_base</span><span class="si">}</span><span class="s2">&amp;full_text=1&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Anschließend müssen wir für die neue request_url wieder eine Anfrage stellen und können dann über den Schlüssel “full_text” auf den Volltext zugreifen und diesen herunterladen.</p>
<p>Da es etwas unübersichtlich ist, wenn die heruntergeladenen Dateien in demselben Ordner liegen wie das Pythonskript, legen wir zunächst in unserem aktuellen Arbeitsverzeichnis (=Ordner, in dem die Jupyter Notebooks liegen) ein neues Verzeichnis an, in dem wir die Volltexte abspeichern werden:</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Neues Verzeichnis anlegen: in diesem Ordner werden die Textdateien gespeichert</span>
<span class="c1"># Das geht alternativ auch mit dem Paket pathlib, das ihr im Kapitel 8.2 kennengelernt habt</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;loc_ocr&quot;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># exists_ok: nur erstellen, falls es noch nicht existiert</span>
</pre></div>
</div>
</div>
</div>
<p>Jetzt haben wir alles vorbereitet und können die Texte herunterladen. Allerdings brauchen wir dazu noch geeignete Dateinamen für die Dateien.</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">search_results</span><span class="p">:</span>
    <span class="n">fulltext_url</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;word_coordinates_url&quot;</span><span class="p">]</span>
    <span class="n">fulltext_base</span> <span class="o">=</span> <span class="n">fulltext_url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fulltext_request_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fulltext_base</span><span class="si">}</span><span class="s2">&amp;full_text=1&quot;</span>
    <span class="n">fulltext_dict</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fulltext_request_url</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">dict_values</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fulltext_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">fulltext</span> <span class="o">=</span> <span class="n">dict_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;full_text&quot;</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">.txt&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fulltext</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Wie gehen wir vor, um jetzt unsere for-Schleife oben nacheinander auf alle Ergebnisseiten anzuwenden? Erinnert euch an die drei Strategien, die wir beim Scrapen der Quotes to Scrape-Website im Abschnitt “Fortsetzung BeautifulSoup” diskutiert haben. Eine andere Strategie, die wir im Zusammenhang mit der Quotes to Scrape-Website besprochen haben, war die Verwendung des “next”-Buttons. Bei dieser Strategie haben wir beim Aufruf einer Seite die URL zur nachfolgenden Seite aus dem href-Attribut des a-Elements mit dem Text “next” extrahiert und diese URL zur Formulierung der nächsten Anfrage verwendet.</p>
<p>Ganz ähnlich funktioniert auch die Lösung, die das vorhin besprochene Tutorial der Library Of Congress vorschlägt. Hier wurde die URL für die nächste Ergebnisseite dem Schlüssel “next” unter dem Schlüssel “pagination” entnommen (s.o.). Diese Lösung bauen wir nun in unseren Code ein:</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://www.loc.gov/collections/chronicling-america/&quot;</span>
<span class="n">display_level</span> <span class="o">=</span> <span class="s2">&quot;dl=page&quot;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s2">&quot;end_date=1936-09-03&quot;</span>
<span class="n">search_operation</span> <span class="o">=</span> <span class="s2">&quot;ops=PHRASE&quot;</span>
<span class="n">query_terms</span> <span class="o">=</span> <span class="s2">&quot;qs=book+review&quot;</span>
<span class="n">search_type</span> <span class="o">=</span> <span class="s2">&quot;searchType=advanced&quot;</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s2">&quot;start_date=1736-09-03&quot;</span>
<span class="n">response_format</span> <span class="o">=</span> <span class="s2">&quot;fo=json&quot;</span>

<span class="n">request_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">?</span><span class="si">{</span><span class="n">display_level</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">search_operation</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">query_terms</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">search_type</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">response_format</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">current_url</span> <span class="o">=</span> <span class="n">request_url</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">current_url</span><span class="p">)</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current_url</span><span class="p">)</span>
  <span class="n">response_dict</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
  <span class="n">search_results</span> <span class="o">=</span> <span class="n">response_dict</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">search_results</span><span class="p">:</span>
    <span class="n">fulltext_url</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;word_coordinates_url&quot;</span><span class="p">]</span>
    <span class="n">fulltext_base</span> <span class="o">=</span> <span class="n">fulltext_url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fulltext_request_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fulltext_base</span><span class="si">}</span><span class="s2">&amp;full_text=1&quot;</span>
    <span class="n">fulltext_dict</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fulltext_request_url</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">dict_values</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fulltext_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">fulltext</span> <span class="o">=</span> <span class="n">dict_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;full_text&quot;</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">.txt&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fulltext</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">response_dict</span><span class="p">[</span><span class="s2">&quot;pagination&quot;</span><span class="p">][</span><span class="s2">&quot;next&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">current_url</span> <span class="o">=</span> <span class="n">response_dict</span><span class="p">[</span><span class="s2">&quot;pagination&quot;</span><span class="p">][</span><span class="s2">&quot;next&quot;</span><span class="p">]</span>

  <span class="k">else</span><span class="p">:</span>
      <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Verständnisfragen</p>
<ul class="simple">
<li><p>Wie könnte man diese Aufgabe noch lösen?</p></li>
<li><p>Gibt es eine alternative Vorgehensweise, an die URLs der nachfolgenden Ergebnisseiten zu kommen?</p></li>
<li><p>Gibt es andere Strategien, um an die Links zu den Volltexten zu gelangen?</p></li>
</ul>
</div>
<p>Aber Achtung! Beim Ausführen des Codes oben gibt es nach einigen Schleifendurchläufen eine Fehlermeldung: JSONDecodeError: Expecting value: line 1 column 1 (char 0). Die Fehlermeldung entsteht dann, wenn die HTTP-Anfrage keine erfolgreiche Antwort liefert. Dieser Fall kann registriert werden, indem nach jeder Anfrage der Statuscode ausgegeben wird. Warum hat die Anfrage plötzlich keine erfolgreiche Antwort geliefert? Das liegt daran, dass wir uns nicht an die Einschränkungen der LOC gehalten haben und die HTTP-Anfrage dadurch ab einem bestimmten Punkt abgelehnt wird. Wenn wir dann versuchen, den Antwortbody mithilfe der .json()-Methode in ein Python Dictionary umzuwandeln, teilt der Python interpreter uns mit, dass das nicht möglich ist, weil wir die Methode nicht auf einen gültigen JSON-String angewendet haben.</p>
<p>Bei der Abfrage von sehr vielen Seiten müssen wir uns also nach den Einschränkungen der LOC richten und bestimmte Abfrageraten (Rate Limits) einhalten.</p>
</section>
<section id="rate-limits-berucksichtigen-und-die-abfragerate-steuern">
<h2><span class="section-number">8.3.5. </span>Rate Limits berücksichtigen und die Abfragerate steuern<a class="headerlink" href="#rate-limits-berucksichtigen-und-die-abfragerate-steuern" title="Link to this heading">#</a></h2>
<p>Wie wir bereits in der kurzen Einführung zu APIs besprochen haben, setzen Webseitenbetreiber:innen für gewöhnlich Grenzen für die Datenabfrage über ihre APIs fest. Manche kommunizieren diese Einschränkungen nur schriftlich in Form der Dokumentation, andere setzen sie technisch fest, sodass wiederholte Anfragen desselben Clients automatisch bei Überschreiten der erlaubten Abfragerate blockiert werden. Um dies zu verhindern und um den Server nicht mit vielen Anfragen, die schnell nacheinander gestellt werden, zu überlasten, muss der Code so geschrieben werden, dass die erlaubte Abfragerate der API eingehalten werden. Dazu können verschiedene Strategien angewandt werden, die in diesem Abschnitt vorgestellt werden.</p>
<p>Eine Recherche auf den Seiten der Library of Congress liefert die Seite <a class="reference external" href="https://www.loc.gov/apis/json-and-yaml/working-within-limits">https://www.loc.gov/apis/json-and-yaml/working-within-limits</a>. Hier legt die LOC Einschränkungen für die der Chronicling America API übergeordnete Seite <a class="reference external" href="http://loc.gov">loc.gov</a> fest. Die Chronicling America API wird zwar nicht explizit erwähnt, aber wir können vermuten, dass die Einschränkungen auch für die Chronicling America API gelten. Da etwas unklar ist, welches Limit für diese API gilt, richten wir uns nach der restriktivsten Vorgabe, nach der nur 20 Abfragen alle 10 Sekunden erlaubt sind. So sind wir in jedem Fall auf der sicheren Seite.</p>
<p>Wie können wir also die HTTP-Abfragen auf 20 Abfragen je 10 Sekunden einschränken? Dazu müssen wir den Code so umschreiben, dass innerhalb einer bestimmten Zeit nur eine bestimmte Anzahl an Anfragen gestellt werden.</p>
<p>Um die Abfragerate einzuschränken, gibt es mehrere Möglichkeiten:</p>
<ol class="arabic simple">
<li><p><strong>Funktion <code class="docutils literal notranslate"><span class="pre">time.sleep()</span></code> aus dem Paket time</strong>. Die Funktion time.sleep(x) kann in den Schleifenkörper einer for-Schleife eingefügt werden, um den nächsten Schleifendurchlauf um x Sekunden zu verzögern. Diese Methode ist einstiegsfreundlich, aber ungenau, weil die Laufzeit der Schleife selbst nicht in die Wartezeit mit einbezogen wird, sodass der nächste Schleifendurchlauf länger als notwendig verzögert wird. Auch ist es schwierig, mit dieser Strategie die Abfragerate zu kontrollieren, wenn Anfragen auf mehrere Schleifen verteilt sind wie im LOC-Beispiel.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rate limiting mit time.sleep(): Allgemeines Schema</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rate limiting mit time.sleep():  LOC API</span>

<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">search_results</span><span class="p">:</span>
    <span class="n">fulltext_url</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;word_coordinates_url&quot;</span><span class="p">]</span>
    <span class="n">fulltext_base</span> <span class="o">=</span> <span class="n">fulltext_url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fulltext_request_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fulltext_base</span><span class="si">}</span><span class="s2">&amp;full_text=1&quot;</span>
    <span class="n">fulltext_dict</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fulltext_request_url</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">dict_values</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fulltext_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">fulltext</span> <span class="o">=</span> <span class="n">dict_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;full_text&quot;</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">.txt&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fulltext</span><span class="p">)</span>

    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Python Dekoratoren aus dem Paket ratelimit</strong>. Wesentlich effizienter und eleganter ist die Verwendung von sogenannten Python Dekoratoren bzw. Decorators. Das Paket ratelimit bietet zwei solche Dekoratoren, die dazu verwendet werden können, um zu registrieren, wie häufig eine Funktion nacheinander aufgerufen wird, und die ab einer bestimmten Anzahl wiederholter Aufrufe eine Wartepause erzwingen. Um Decorators verwenden zu können, müssen wir unsere Abfrage jedoch in eine Funktion verpacken. Das Paket ratelimit wie auch die gängigen und immer noch viel verwendeten Alternativen (z.B. ratelimiter), werden allerdings seit einigen Jahren nicht mehr maintained. Das heißt, dass der Code bereits sehr alt ist und Probleme, auf die User:innen die Entwickler:innen des Pakets aufmerksam machen, nicht mehr behoben werden. So hat zum Beispiel GitHub User:in Justin VanWinkle <a class="reference external" href="https://gist.github.com/justinvanwinkle/d9f04950083c4554835c1a35f9d22dad">darauf hingewiesen</a>, dass ratelimit in bestimmten Umständen die Abfragerate nicht zuverlässig kontrolliert.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Python Dekoratoren (Decorators)</p>
<blockquote>
<div><p>A decorator in Python is a function that accepts another function as an argument. The decorator will usually modify or enhance the function it accepted and return the modified function. This means that when you call a decorated function, you will get a function that may be a little different that may have additional features compared with the base definition.</p>
</div></blockquote>
<p>Quelle: <a class="reference external" href="https://python101.pythonlibrary.org/chapter25_decorators.html">Michael Droscill (2017).</a></p>
<p>Dekoratoren beruhen auf einem komplexen Konzept und wir können hier nicht tiefer einsteigen, aber wenn die ein oder andere Person doch etwas tiefer einsteigen will, kann ich diese beiden Ressourcen empfehlen:</p>
<ul class="simple">
<li><p>Primer on Python Decorators, <a class="reference external" href="https://realpython.com/primer-on-python-decorators/">https://realpython.com/primer-on-python-decorators/</a></p></li>
<li><p>Python Decorators in 15 Minutes, <a class="reference external" href="https://www.youtube.com/watch?v=r7Dtus7N4pI">https://www.youtube.com/watch?v=r7Dtus7N4pI</a></p></li>
</ul>
<p>Bei der Verwendung der Dekoratoren aus dem Paket ratelimit verwenden wir diese Anleitung von Akshay Ranganath:</p>
<ul class="simple">
<li><p>Rate Limiting with Python, <a class="reference external" href="https://akshayranganath.github.io/Rate-Limiting-With-Python/">https://akshayranganath.github.io/Rate-Limiting-With-Python/</a></p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># wir müssen zunächst die Anaconda Einstellungen ändern, damit wir das Paket ratelimit installieren können:</span>
<span class="c1"># import sys</span>
<span class="c1"># !conda config --append channels conda-forge</span>
<span class="c1"># Paket ratelimit installieren</span>
<span class="c1"># !conda install --yes --prefix {sys.prefix} ratelimit</span>

<span class="kn">from</span> <span class="nn">ratelimit</span> <span class="kn">import</span> <span class="n">limits</span><span class="p">,</span> <span class="n">sleep_and_retry</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rate limiting mit Python decorators: Allgemeines Schema</span>

<span class="n">PERIOD_SEC</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">CALLS_PER_PERIOD_SEC</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># 3 Abfragen in 10 Sekunden</span>

<span class="nd">@sleep_and_retry</span>
<span class="nd">@limits</span><span class="p">(</span><span class="n">calls</span><span class="o">=</span><span class="n">CALLS_PER_PERIOD_SEC</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="n">PERIOD_SEC</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
    <span class="n">test_function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
2
3
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
5
</pre></div>
</div>
</div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rate limiting mit Python decorators: LOC API</span>

<span class="n">PERIOD_SEC</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">CALLS_PER_PERIOD_SEC</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># 20 Abfragen in 10 Sekunden</span>

<span class="nd">@sleep_and_retry</span>
<span class="nd">@limits</span><span class="p">(</span><span class="n">calls</span><span class="o">=</span><span class="n">CALLS_PER_PERIOD_SEC</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="n">PERIOD_SEC</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_json</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">search_results</span><span class="p">:</span>
    <span class="n">fulltext_url</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;word_coordinates_url&quot;</span><span class="p">]</span>
    <span class="n">fulltext_base</span> <span class="o">=</span> <span class="n">fulltext_url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fulltext_request_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fulltext_base</span><span class="si">}</span><span class="s2">&amp;full_text=1&quot;</span>
    <span class="n">fulltext_dict</span> <span class="o">=</span> <span class="n">get_json</span><span class="p">(</span><span class="n">fulltext_request_url</span><span class="p">)</span>
    <span class="n">dict_values</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fulltext_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">fulltext</span> <span class="o">=</span> <span class="n">dict_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;full_text&quot;</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">.txt&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fulltext</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Beachtet, dass diese Funktionsdefinition sich in einem wichtigen Aspekt von der Definition der Funktion scrape_quotes() im Abschnitt “Fortsetzung BeautifulSoup” unterscheidet: Beim Aufruf der Funktion get_json() wird nur genau eine Anfrage gestellt und die Funktion wird aus einer Schleife heraus aufgerufen. Die Funktion scrape_quotes() dagegen stellt beim Aufruf mehrere Anfragen und die for-Schleife, die über die zu scrapenden URLs iteriert, befindet sich in der Funktionsdefinition selbst. Bei der Verwendung der Dekoratoren zum Rate Limiting muss darauf geachtet werden, dass die Funktion so definiert ist wie die get_json()-Funktion. Die Funktionsaufrufe können nämlich nur dann mithilfe der Funktionsaufrufe verzögert werden, wenn die Funktion auch mehrmals aufgerufen wird!</p>
<ol class="arabic simple" start="3">
<li><p><strong>Feingranulares Rate Limiting mit dem Paket limits</strong>. Eine Alternative, die etwas mehr Code und Hintergrundwissen erfordert aber dafür auch viele Anpassungsmöglichkeiten bietet, ist das <a class="reference external" href="https://limits.readthedocs.io/en/latest/index.html">Paket limits</a>. Das Paket ist eigentlich eher zur Implementierung von Rate Limiting in Schnittstellen und Softwaresystemen gedacht. Die Dokumentationsseiten beschreiben deswegen viele Anwendungsfälle und Konfigurationen, die recht komplex und für uns nicht relevant sind. Es kann beispielsweise zwischen verschiedenen Rate Limiting-Strategien ausgewählt werden und es kann festgelegt werden, ob die Anzahl der vergangenen Anfragen im Arbeitsspeicher oder einer externen Datenbank gespeichert werden soll. Für unsere Zwecke reicht immer der Arbeitsspeicher und die anderen Optionen können wir ignorieren. Ein möglicher Einsatz von limits zum Überwachen und Kontrollieren der Abfragerate im Rahmen von API-Abfragen könnte so aussehen:</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">limits</span> <span class="kn">import</span> <span class="n">strategies</span><span class="p">,</span> <span class="n">storage</span><span class="p">,</span> <span class="n">parse</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rate limiting mit dem Paket limits: Allgemeines Schema</span>

<span class="c1"># Rate limit festlegen, z.B. drei Anfragen pro Sekunde. Hier geht auch z.B. &quot;40/minute&quot;, &quot;3/2seconds&quot; oder &quot;1 per second&quot; according to https://limits.readthedocs.io/en/latest/api.html#limits.parse</span>
<span class="n">rate_limit</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s2">&quot;3/second&quot;</span><span class="p">)</span>
<span class="c1"># Speicherort festlegen: Anzahl der vergangenen Anfragen werden im Arbeitsspeicher gehalten (theoretisch ginge auch eine externe Datenbank)</span>
<span class="n">memory_storage</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">MemoryStorage</span><span class="p">()</span>
<span class="c1"># Strategie festlegen und Moving window rate limiter Objekt erstellen</span>
<span class="n">moving_window</span> <span class="o">=</span> <span class="n">strategies</span><span class="o">.</span><span class="n">MovingWindowRateLimiter</span><span class="p">(</span><span class="n">memory_storage</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">moving_window</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">rate_limit</span><span class="p">,</span> <span class="s2">&quot;test_requests&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rate limit exceeded for iteration </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">, waiting to retry...&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># alternativ 0.01 oder 0.1</span>
    <span class="n">moving_window</span><span class="o">.</span><span class="n">hit</span><span class="p">(</span><span class="n">rate_limit</span><span class="p">,</span> <span class="s2">&quot;test_requests&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
2
3
Rate limit exceeded for iteration 4, waiting to retry...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
5
</pre></div>
</div>
</div>
</div>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rate limiting mit Paket limits: LOC API</span>

<span class="n">rate_limit</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s2">&quot;20/10seconds&quot;</span><span class="p">)</span>
<span class="n">memory_storage</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">MemoryStorage</span><span class="p">()</span>
<span class="n">moving_window</span> <span class="o">=</span> <span class="n">strategies</span><span class="o">.</span><span class="n">MovingWindowRateLimiter</span><span class="p">(</span><span class="n">memory_storage</span><span class="p">)</span>

<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">search_results</span><span class="p">:</span>
    <span class="n">fulltext_url</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;word_coordinates_url&quot;</span><span class="p">]</span>
    <span class="n">fulltext_base</span> <span class="o">=</span> <span class="n">fulltext_url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fulltext_request_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fulltext_base</span><span class="si">}</span><span class="s2">&amp;full_text=1&quot;</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="n">moving_window</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">rate_limit</span><span class="p">,</span> <span class="s2">&quot;loc_requests&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rate limit exceeded, waiting to retry...&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="n">moving_window</span><span class="o">.</span><span class="n">hit</span><span class="p">(</span><span class="n">rate_limit</span><span class="p">,</span> <span class="s2">&quot;loc_requests&quot;</span><span class="p">)</span>
    <span class="n">fulltext_dict</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fulltext_request_url</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">dict_values</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fulltext_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">fulltext</span> <span class="o">=</span> <span class="n">dict_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;full_text&quot;</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">.txt&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fulltext</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Die Methode .test() überprüft, ob das Rate Limit bereits erreicht wurde oder nicht, also ob im angegebenen Zeitfenster (hier 10 Sekunden) bereits die erlaubte Anzahl an Anfragen gestellt wurden (hier 20). Wenn das Limit erreicht wurde, wird False zurückgegeben, ansonsten True. Die Bedingung <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">moving_window.test(rate_limit,</span> <span class="pre">&quot;loc_requests&quot;)</span></code> wird also genau dann True, wenn das Limit erreicht wurde und 20 Anfragen in 10 Sekunden gestellt wurden. In diesem Fall wird gewartet, bis genug Zeit vergangen ist und wieder Anfragen erlaubt sind. Mit der Methode .hit() wird in jedem Durchlauf der for-Schleife eine Anfrage registriert, damit sich der Zähler für die Anzahl der bisher gestellten Anfragen im Objekt memory_storage erhöht. Mehr dazu könnt ihr in den <a class="reference external" href="https://limits.readthedocs.io/en/stable/index.html">Dokumentationsseiten des Pakets limits</a> nachlesen.</p>
<p><strong>Weitere Hinweise zum Rate Limiting</strong></p>
<p>Neben den drei hier vorgestellten Strategien gibt es noch weitere Möglichkeiten, die Abfragerate zu kontrollieren. Manche Schnittstellen senden bei einer nicht erfolgreichen Anfrage einen Retry-After Header mit, der angibt, wie lange der Client bis zur nächsten Anfrage warten soll. Das in <a class="reference external" href="https://programminghistorian.org/en/lessons/interactive-data-visualization-dashboard#downloading-the-data">diesem Blogbeitrag</a> verlinkte Python-Skript nutzt beispielsweise den Retry-After-Header der HTTP-Antwort bei der Abfrage von Daten über die Chronicling America API.</p>
<p>Neben der Abfragerate können auch die Anzahl der Retries, also die Anzahl der wiederholten Anfragen beim Scheitern einer Anfrage gesteuert werden. Dabei wird häufig die Wartezeit nach jeder gescheiterten Anfrage erhöht. Wenn die Wartezeit dabei exponentiell erhöht wird, nennt man dieses Warteverhalten auch “exponential backoff” (mehr dazu <a class="reference external" href="https://substack.thewebscraping.club/p/rate-limit-scraping-exponential-backoff">hier</a>). Wie sich eine Retry-Strategie mit requests umsetzen lässt, könnt ihr am Ende des Semesters im Kapitel “Tipps und Tricks” nachlesen.</p>
<p>Beachtet auch, dass es sehr oft empfehlenswert ist, auch beim einfachen Rate Limiting mit time.sleep() oder dem Rate Limiting mit dem Paket limits eine Funktion zu definieren und das Rate Limiting in dieser Funktion zu implementieren. Denn wenn an mehreren Stellen im Code Anfragen an dieselbe Schnittstelle gestellt werden, muss an jeder Stelle der Code zum Warten wiederholt werden.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Konstanten (Constants)</p>
<p>Im Code oben verwenden wir Großbuchstaben, um die Variablen <code class="docutils literal notranslate"><span class="pre">CALLS_PER_PERIOD_SEC</span></code> und <code class="docutils literal notranslate"><span class="pre">PERIOD_SEC</span></code> zu benennen. Diese Schreibweise hat sich in Python für Konstanten etabliert, also für Variablen, deren Wert sich im Programmverlauf nicht ändert.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Wahl des Dateinamens</p>
<p>In den Beispielen auf dieser Seite haben wir den Titel der Ressource als Dateinamen gewählt. Diese Metadaten sind aber eigentlich nicht ausreichend, um den Dateiinhalt eindeutig zu identifizieren, denn die Suchergebnisse beziehen sich nur auf eine Seite aus der angegebenen Ausgabe. Sobald unsere Suche mehr als eine Seite aus derselben Ausgabe liefert, gibt es möglicherweise mehrere Dateien mit denselben Namen, sodass Dateien möglicherweise überschrieben werden! Wie kann das Problem gelöst werden?</p>
<p>Lösung 1: Es werden noch mehr Metadaten, zum Beispiel die Seitenzahl, in den Dateinamen aufgenommen. Aber Achtung: Dateipfade dürfen auf den meisten Betriebssystemen höchstens 255 Zeichen lang sein. Wir müssen uns bei der Wahl der Metadaten also sicher sein, dass unter dem entsprechenden Schlüssel niemals eine sehr lange Zeichenkette steht. Wenn wir uns dem nicht sicher sein können, sollten zu lange Dateinamen mit if…else erkannt und behandelt (z.B. gekürzt) werden. Für die Validierung von Dateinamen gibt es auch ein spezialisiertes Paket, <a class="reference external" href="https://pathvalidate.readthedocs.io/en/latest/pages/reference/function.html"><code class="docutils literal notranslate"><span class="pre">pathvalidate</span></code></a>.</p>
<p>Lösung 2: Wir verwenden den Schlüssel “page_id” als Dateinamen. Die ID ist immer eine Zeichenkette der Form “sn85060004-1936-03-29-ed-1-1005”. Allerdings müssen wir uns dann auch eine effiziente Strategie, wie zu dem Suchergebnis mit der angegebenen ID weitere Metadaten abgerufen werden können, überlegen und die entsprechende Abfragelogik in Python implementieren. Ein weiteres Problem stellt die ID selbst dar, denn die Schrägstriche sind von Schrägstrichen, die Teil des Dateipfads sind, nicht zu unterscheiden. Beim Schreiben der Datei versucht der Computer also, ein Verzeichnis mit dem Namen lccn zu finden, das vermutlich nicht existiert. Um die ID verwenden zu können, können die Schrägstriche aber einfach durch Unterstriche ersetzt werden. Das geht zum Beispiel mit dem Modul <a class="reference external" href="https://docs.python.org/3/library/re.html"><code class="docutils literal notranslate"><span class="pre">re</span></code></a>, das wir ganz am Ende des Semesters kurz besprechen werden.</p>
<p>Ihr seht: einen optimalen Dateinamen gibt es oft nicht. <strong>Als Faustregel solltet ihr euch merken, dass Dateinamen immer den Inhalt eindeutig indentifizieren sollten, keine Sonderzeichen wie Schrägstriche und Leerzeichen enthalten sollten, und nicht zu lang sein dürfen.</strong></p>
</div>
</section>
<section id="quellen">
<h2><span class="section-number">8.3.6. </span>Quellen<a class="headerlink" href="#quellen" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id1">
<ol class="arabic simple" start="1">
<li id="id133"><p>Michael Driscoll. Chapter 25 – Decorators. 2017. URL: <a class="reference external" href="https://python101.pythonlibrary.org/chapter25_decorators.html">https://python101.pythonlibrary.org/chapter25_decorators.html</a>.</p></li>
<li id="id135"><p>Akshay Ranganath. Rate Limiting with Python. 2021. URL: <a class="reference external" href="https://akshayranganath.github.io/Rate-Limiting-With-Python/">https://akshayranganath.github.io/Rate-Limiting-With-Python/</a>.</p></li>
<li id="id136"><p>Guido van Rossum, Barry Warsaw, and Nick Coghlan. PEP 8: Constants. 2013. URL: <a class="reference external" href="https://peps.python.org/pep-0008/#constants">https://peps.python.org/pep-0008/#constants</a>.</p></li>
<li id="id132"><p>Geir Arne Hjelle. Primer on Python Decorators. 2023. URL: <a class="reference external" href="https://realpython.com/primer-on-python-decorators/">https://realpython.com/primer-on-python-decorators/</a>.</p></li>
<li id="id134"><p>Kite. Python Decorators in 15 Minutes. 2020. URL: <a class="reference external" href="https://www.youtube.com/watch?v=r7Dtus7N4pI">https://www.youtube.com/watch?v=r7Dtus7N4pI</a>.</p></li>
<li id="id137"><p>Leodanis Pozo Ramos. Python Constants: Improve Your Code's Maintainability. 2022. URL: <a class="reference external" href="https://realpython.com/python-constants/">https://realpython.com/python-constants/</a>.</p></li>
<li id="id141"><p>Library of Congress. Chronicling America. About the Site and API. 2023. URL: <a class="reference external" href="https://chroniclingamerica.loc.gov/about/api/">https://chroniclingamerica.loc.gov/about/api/</a>.</p></li>
<li id="id140"><p>Library of Congress. Working Within Limits. 2023. URL: <a class="reference external" href="https://www.loc.gov/apis/json-and-yaml/working-within-limits">https://www.loc.gov/apis/json-and-yaml/working-within-limits</a>.</p></li>
<li id="id139"><p>Limits 3.14.1 Documentation. Quickstart. 2023. URL: <a class="reference external" href="https://limits.readthedocs.io/en/stable/quickstart.html">https://limits.readthedocs.io/en/stable/quickstart.html</a>.</p></li>
<li id="id138"><p>Limits 3.14.1 Documentation. Rate Limiting Strategies. 2023. URL: <a class="reference external" href="https://limits.readthedocs.io/en/stable/strategies.html">https://limits.readthedocs.io/en/stable/strategies.html</a>.</p></li>
</ol>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/08/subchapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02_dracor_api.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">8.2. </span>Beispiel 1: DraCor API</p>
      </div>
    </a>
    <a class="right-next"
       href="../../09/09_intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">9. </span>Anwendungsfall III: Dynamische Webseiten</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datenqualitat-untersuchen">8.3.1. Datenqualität untersuchen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suche-formulieren">8.3.2. Suche formulieren</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anfrage-formulieren">8.3.3. Anfrage formulieren</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#abfrage-aller-volltexte-mit-book-review">8.3.4. Abfrage aller Volltexte mit “book review”</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rate-limits-berucksichtigen-und-die-abfragerate-steuern">8.3.5. Rate Limits berücksichtigen und die Abfragerate steuern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quellen">8.3.6. Quellen</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lisa Poggel
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>